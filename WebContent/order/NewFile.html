<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="shortcut icon" href="http://www.google.com/s2/favicons?domain=www.iiitd.ac.in" type="image/x-icon">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
		  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<title>New Order &#8226; PizzeriaSystem</title>
		<style type="text/css">
			.delete-order
			{
				color:red;
			}
			.list-group-item
			{
				font-size: 30px;
			}
			.modal-dialog
			{
			  width: 70%;
			}
			.hero-feature-inactive:hover
			{
				background: #CFCFCF;
			}
			.hero-feature-active
			{
				background: #33FF99;
			}
		</style>
	</head>

	<body style="background-image:url('http://www.zastavki.com/pictures/1600x1200/2009/Food_Pizza_Filling_Pizza_011932_.jpg');background-size: 100% 100%;background-repeat:no-repeat;background-position:right bottom;" >
	<!-- Modal -->
		<div id="PizzaSelect" class="modal fade" role="dialog" width="700px">
		  <div class="modal-dialog" width="700px">

		    <!-- Modal content-->
		    <div class="modal-content">
		      <div class="modal-header">
		        <button type="button" class="close" data-dismiss="modal">&times;</button>
		        <h4 class="modal-title">Select Pizza</h4>
		      </div>
		      <div class="modal-body">
		      	<div class="container-fluid"><div class="row">
		        <div class="col-md-3 col-sm-6 hero-feature">
                <div class="thumbnail hero-feature-active">
                	<div class="image-container" style="height:248px;">
                    	<img src="http://cdn-image.myrecipes.com/sites/default/files/styles/300x300/public/image/recipes/su/10/02/pizzetta-margherita-pizza-su-x.jpg?itok=vE2-vQlo" style="height:255px;width:245px;" alt="" >
                    </div>
                    <div class="caption">
                        <h3>Cheese Margherita</h3>
                    </div>
                </div>
            	</div>

            <div class="col-md-3 col-sm-6 hero-feature">
                <div class="thumbnail hero-feature-inactive">
                	<div class="image-container" style="height:248px;">
                    	<img src="http://www.segielskiphoto.com/data/photos/151_1stuffed_crust_pizza.jpg" style="height:255px;width:245px;" alt="" >
                    </div>
                    <div class="caption">
                        <h3>Pepperoni Pizza</h3>
                    </div>
                </div>
            	</div>

            <div class="col-md-3 col-sm-6 hero-feature">
                <div class="thumbnail hero-feature-inactive">
                	<div class="image-container" style="height:248px;">
                    	<img src="http://wayoutwestaustin.com/wp-content/uploads/2012/12/SPpizza.jpg" style="height:255px;width:245px;" alt="" >
                    </div>
                    <div class="caption">
                        <h3>Farmhouse</h3>
                    </div>
                </div>
            	</div>

            <div class="col-md-3 col-sm-6 hero-feature">
                <div class="thumbnail hero-feature-inactive">
                	<div class="image-container" style="height:248px;">
                    	<img src="https://giordanos.com/cms/wp-content/uploads/2014/01/PizzaPull.jpg" style="height:255px;width:245px;" alt="" >
                    </div>
                    <div class="caption">
                        <h3>Monster Deep Dish</h3>
                    </div>
                </div>
            	</div>
		      </div>
		      <div class="row">
		      	<div class="col-lg-6">
		      		<div class="btn-group btn-group-justified">
					  <a href="#" class="btn btn-primary size-btn">SMALL</a>
					  <a href="#" class="btn btn-default size-btn">MEDIUM</a>
					  <a href="#" class="btn btn-default size-btn">LARGE</a>
					</div>
		      	</div>
		      	<div class="col-lg-3" style="text-align:right;font-size:20px;">QUANTITY:</div>
		      	<div class="col-lg-3">
		      		<div class="input-group">
			          <span class="input-group-btn">
			              <button type="button" class="btn btn-default btn-number" disabled="disabled" data-type="minus" data-field="quant[1]">
			                  <span class="glyphicon glyphicon-minus"></span>
			              </button>
			          </span>
			          <input type="text" name="quant[1]" class="form-control input-number" value="1" min="1" max="10" disabled>
			          <span class="input-group-btn">
			              <button type="button" class="btn btn-default btn-number" data-type="plus" data-field="quant[1]">
			                  <span class="glyphicon glyphicon-plus"></span>
			              </button>
			          </span>
      				</div>
		      	</div>
		      </div>
		  		</div></div>
		      <div class="modal-footer">
		      	<button type="button" class="btn btn-default" id="pizza-add-btn" data-dismiss="modal">ADD SELECTION</button>
		        <button type="button" class="btn btn-default" data-dismiss="modal">CANCEL</button>
		      </div>
		    </div>

		  </div>
		</div>
	<div class="container">
	<div class="row"><div class="col-lg-8"><h1>Pizzeria System</h1></div>
	<div class="col-lg-4"><h1 id="OrderIDHead">Order ID:</h1></div></div>
	<div class="row"><div class="col-lg-12" style="height:768px;"><h1>Please select your order:</h1><br/>
		<center><h1>Current Order</h1></center>
		  <div class="panel panel-default">
				<div class="list-group" id="order-list">
				</div>
		  </div>
		<button class="btn btn-lg btn-danger" data-toggle="modal" data-target="#PizzaSelect">Add Pizza</button>
		<button class="btn btn-lg btn-primary" id="submit-order">Submit</button>
	</div></div></div>
		<script type="text/javascript">
			function readCookie(name) {
			    var nameEQ = name + "=";
			    var ca = document.cookie.split(';');
			    for(var i=0;i < ca.length;i++) {
			        var c = ca[i];
			        while (c.charAt(0)==' ') c = c.substring(1,c.length);
			        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
			    }
			    return null;
			}
			$("#OrderIDHead").text($("#OrderIDHead").text()+readCookie("orderID"));
			window.onload = function() {
			    if(!window.location.hash) {
			        window.location = window.location + '#loaded';
			        window.location.reload();
			    }
			}

			$('.hero-feature').on('click',function()
			{
				$('.hero-feature > .thumbnail').removeClass('hero-feature-active');
				$('.hero-feature > .thumbnail').addClass('hero-feature-inactive');
				$(this).children('.thumbnail').removeClass('hero-feature-inactive');
				$(this).children('.thumbnail').addClass('hero-feature-active');
			});

			$('.size-btn').on('click',function()
			{
				$('.size-btn').removeClass('btn-primary');
				$('.size-btn').addClass('btn-default');
				$(this).removeClass('btn-default');
				$(this).addClass('btn-primary');
			});
			$('.btn-number').click(function(e){
			    e.preventDefault();
			    
			    fieldName = $(this).attr('data-field');
			    type      = $(this).attr('data-type');
			    var input = $("input[name='"+fieldName+"']");
			    var currentVal = parseInt(input.val());
			    if (!isNaN(currentVal)) {
			        if(type == 'minus') {
			            
			            if(currentVal > input.attr('min')) {
			                input.val(currentVal - 1).change();
			            } 
			            if(parseInt(input.val()) == input.attr('min')) {
			                $(this).attr('disabled', true);
			            }

			        } else if(type == 'plus') {

			            if(currentVal < input.attr('max')) {
			                input.val(currentVal + 1).change();
			            }
			            if(parseInt(input.val()) == input.attr('max')) {
			                $(this).attr('disabled', true);
			            }

			        }
			    } else {
			        input.val(0);
			    }
			});
			$('.input-number').focusin(function(){
			   $(this).data('oldValue', $(this).val());
			});
			$('.input-number').change(function() {
			    
			    minValue =  parseInt($(this).attr('min'));
			    maxValue =  parseInt($(this).attr('max'));
			    valueCurrent = parseInt($(this).val());
			    
			    name = $(this).attr('name');
			    if(valueCurrent >= minValue) {
			        $(".btn-number[data-type='minus'][data-field='"+name+"']").removeAttr('disabled')
			    } else {
			        alert('Sorry, the minimum value was reached');
			        $(this).val($(this).data('oldValue'));
			    }
			    if(valueCurrent <= maxValue) {
			        $(".btn-number[data-type='plus'][data-field='"+name+"']").removeAttr('disabled')
			    } else {
			        alert('Sorry, the maximum value was reached');
			        $(this).val($(this).data('oldValue'));
			    }
			});

			$(document.body).on('click','.delete-order',function(){
				$(this).closest("div").remove();
			});

			$('#pizza-add-btn').click(function(){
				pizza = "";
				pizza += $(".hero-feature-active > .caption > h3").text()+",";
				pizza += ($(".size-btn.btn-primary").text()+",").toLowerCase();
				pizza += $(".input-number").val();
				$("#order-list").html($("#order-list").html()+"<div class=\"list-group-item\">"+pizza+"<span style=\"font-size:35px\" class=\"glyphicon glyphicon-minus-sign pull-right delete-order\"></span></div>");
			});

			$('#submit-order').click(function(){
				data = "";
				if($('#order-list').children().length > 0)
				{
					$('#order-list > .list-group-item').each(function(){data+=$(this).text()+";";});
					console.log(data);
					$.post("./CreateOrder",{"data":data});
				}
				else alert("Please select atleast one pizza!!");
			});
		</script>
	</body>
</html>